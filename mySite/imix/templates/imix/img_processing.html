<!DOCTYPE html>
<html lang="en">
{% load static %}
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Processor</title>
    <link rel="stylesheet" href="{% static 'css/header.css' %}">
    <link rel="stylesheet" href="{% static 'css/footer.css' %}">
    <link rel="stylesheet" href="{% static 'css/img_processing.css' %}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>
<body class="bg-dark text-white">
    
    {% include "imix/header.html" %}

    <form action="#">
      <div class="container-fluid mt-3">
          <div class="row">
              <div class="col-sm-8 img-section d-flex justify-content-center mx-2">
                  <div class="upload-container" id="upload-container">
                    <div class="browse" id="browse-section">
                      
                      <p>Drag and drop an image here, or</p>
                      <label for="file-input">Browse</label>
                    <input type="file" id="file-input" accept="image/*">
                    </div>
                    <div id="preview" style="display: none;">
                      <button class="btn btn-primary mt-3" id="reset-button">Browse Again</button>
                    </div>
                  </div>
              </div>
  
              <div class="col-sm-4 menu-section">
                
                
              </div>
          </div>
      </div>
    </form>

    {% include "imix/footer.html" %}
<script>
  
  const uploadContainer = document.getElementById('upload-container');
  const fileInput = document.getElementById('file-input');
  const browseSection = document.getElementById('browse-section');
  const preview = document.getElementById('preview');
  const resetButton = document.getElementById('reset-button');

  // Handle drag-and-drop events
  uploadContainer.addEventListener('dragover', (event) => {
    event.preventDefault();
    uploadContainer.classList.add('dragover');
  });

  uploadContainer.addEventListener('dragleave', () => {
    uploadContainer.classList.remove('dragover');
  });

  uploadContainer.addEventListener('drop', (event) => {
    event.preventDefault();
    uploadContainer.classList.remove('dragover');
    const files = event.dataTransfer.files;
    if (files.length > 0) {
      handleFiles(files[0]);
    }
  });

  // Handle file input change
  fileInput.addEventListener('change', (event) => {
    const file = event.target.files[0];
    if (file) {
      handleFiles(file);
    }
  });

  // Function to handle image file
  function handleFiles(file) {
    if (file.type.startsWith('image/')) {
      const reader = new FileReader();
      reader.onload = (e) => {
        browseSection.style.display = 'none'; // Hide the browse section
        preview.style.display = 'block'; // Show the preview section
        preview.innerHTML = `<img src="${e.target.result}" alt="Uploaded Image" class="img-fluid">
                              <button class="btn btn-primary mt-3" id="reset-button">Browse Again</button>`;
        addResetButtonListener(); // Attach listener to the reset button
      };
      reader.readAsDataURL(file);
    } else {
      alert('Please upload a valid image file.');
    }
  }

  // Function to reset the view
  function resetView() {
    fileInput.value = ''; // Reset the file input
    preview.style.display = 'none'; // Hide the preview section
    browseSection.style.display = 'block'; // Show the browse section
  }

  // Attach event listener to the reset button
  function addResetButtonListener() {
    const resetButton = document.getElementById('reset-button');
    resetButton.addEventListener('click', resetView);
  }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
</body>
</html>